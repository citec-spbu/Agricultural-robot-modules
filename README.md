# Обнаружение пшеницы и сорняков на основе YOLOv8

Данный репозиторий содержит полный рабочий процесс по обнаружению растений пшеницы и сорняков:  
конвертация разметки, подготовка датасета в формате YOLO, обучение модели, валидация и инференс.  
Окончательная модель обучена на YOLOv8 и показывает стабильные результаты даже на небольшом наборе данных.

## Структура репозитория

- `convert_to_yolo.py` — скрипт для преобразования цветовых масок в YOLO-разметку (bounding boxes)  
- `dataset/` — датасет в формате YOLO  
- `cwfid.yaml` — конфигурационный файл датасета  
- `runs/` — логи обучения и сохранённые веса  
- `train3/weights/best.pt` — финальная и лучшая модель  

## Датасет

Исходные маски содержали цветовую разметку:  
- синий цвет — культура (пшеница)  
- зелёный цвет — сорняки  

Скрипт автоматически извлекает минимальные ограничивающие прямоугольники и формирует YOLO-лейблы.

Структура:

dataset/
├── images/
│ ├── train/
│ └── val/
└── labels/
├── train/
└── val/

yaml


## Конвертация разметки

Для генерации YOLO-аннотаций выполните:

```bash
python convert_to_yolo.py
```

Разметка будет сохранена в dataset/labels/.

Обучение модели
Начальное обучение:

```bash
yolo detect train model=yolov8n.pt data=cwfid.yaml 
```
epochs=50 imgsz=640
Дальнейшее дообучение:

```bash
yolo detect train model="runs/detect/train3/weights/best.ptc data=cwfid.yaml epochs=150 imgsz=640
```

Результаты модели (best.pt)
Метрика	Значение
mAP@50	0.82
mAP@50-95	0.54
Precision	0.86
Recall	0.69

Показатели по классам:
Культура (crop)
mAP@50: 0.82
mAP@50-95: 0.56

Сорняки (weed)
mAP@50: 0.81
mAP@50-95: 0.52

Интересно
```bash
yolo detect predict model="runs/detect/train3/weights/best.pt" source="dataset/images/val" save=True
```

Результаты будут сохранены в:
```bash
runs/detect/predict/
```